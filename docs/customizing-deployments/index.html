<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-customizing-deployments">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Kuby RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Kuby Atom Feed"><title data-rh="true">Customizing Deployments | Kuby</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://getkuby.io/docs/customizing-deployments"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Customizing Deployments | Kuby"><meta data-rh="true" name="description" content="Kuby is designed to be beginner-friendly. It requires very little configuration and tries to fall back to smart defaults whenever possible."><meta data-rh="true" property="og:description" content="Kuby is designed to be beginner-friendly. It requires very little configuration and tries to fall back to smart defaults whenever possible."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://getkuby.io/docs/customizing-deployments"><link data-rh="true" rel="alternate" href="https://getkuby.io/docs/customizing-deployments" hreflang="en"><link data-rh="true" rel="alternate" href="https://getkuby.io/docs/customizing-deployments" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.fe22a523.css">
<link rel="preload" href="/assets/js/runtime~main.a05fbcc2.js" as="script">
<link rel="preload" href="/assets/js/main.b30adce0.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Kuby Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.svg" alt="Kuby Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Kuby</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a href="https://github.com/getkuby/kuby-core" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/raison-detre">Overview</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/customizing-docker-build">Customizing Kuby</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/customizing-docker-build">Customizing the Docker Build</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/understanding-kubernetes">Understanding Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/customizing-deployments">Customizing Deployments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/creating-plugins">Creating Your Own Plugins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/environment-variables">Environment Variables</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/managing-secrets">Managing Secrets</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/">üè†</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><span class="breadcrumbs__link" itemprop="item name">Customizing Kuby</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">Customizing Deployments</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Customizing Deployments</h1></header><p>Kuby is designed to be beginner-friendly. It requires very little configuration and tries to fall back to smart defaults whenever possible.</p><p>However, Kuby is also designed to be highly flexible and configurable should the need arise.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="providers">Providers<a class="hash-link" href="#providers" title="Direct link to heading">‚Äã</a></h2><p>A <strong>provider</strong> allows Kuby to communicate with a Kubernetes cluster. Cloud service providers like DigitalOcean, AWS, and Azure, offer hosted Kubernetes solutions that make it very easy to create and manage clusters. There are Kuby provider gems for each of these platforms (and more) that facilitate deploying your application. They handle wrangling the necessary configuration parameters and other trivia.</p><p>Providers are configured inside the <code>kubernetes do ... end</code> block of your Kuby config:</p><div class="codeBlockContainer_I0IT language-ruby theme-code-block"><div class="codeBlockContent_wNvx" style="color:#403f53;background-color:#FBFBFB"><pre tabindex="0" class="prism-code language-ruby codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#403f53"><span class="token plain">Kuby</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">define</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string-literal string" style="color:rgb(72, 118, 214)">&#x27;my-app&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  environment</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token symbol">:production</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    kubernetes </span><span class="token keyword" style="color:rgb(12, 150, 155)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      provider </span><span class="token symbol">:linode</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic"># Linode-specific configuration options go here.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        </span><span class="token comment" style="color:rgb(152, 159, 177);font-style:italic"># See the README in getkuby/kuby-linode for details.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Interested in contributing a provider? See the <a href="https://github.com/getkuby/kuby-core/blob/ab58f7cc308348ae492a2d37dcf88686d2292917/lib/kuby/kubernetes/provider.rb" target="_blank" rel="noopener noreferrer">provider base class</a> for the provider interface.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="available-provider-gems">Available Provider Gems<a class="hash-link" href="#available-provider-gems" title="Direct link to heading">‚Äã</a></h3><p>Kuby currently offers the following providers, distributed as Rubygems:</p><ul><li>DigitalOcean: <a href="https://github.com/getkuby/kuby-digitalocean" target="_blank" rel="noopener noreferrer">getkuby/kuby-digitalocean</a></li><li>Linode: <a href="https://github.com/getkuby/kuby-linode" target="_blank" rel="noopener noreferrer">getkuby/kuby-linode</a></li><li>Amazon EKS: <a href="https://github.com/getkuby/kuby-eks" target="_blank" rel="noopener noreferrer">getkuby/kuby-eks</a></li><li>Azure AKS: <a href="https://github.com/getkuby/kuby-azure" target="_blank" rel="noopener noreferrer">getkuby/kuby-azure</a></li><li>Kind: <a href="https://github.com/getkuby/kuby-kind" target="_blank" rel="noopener noreferrer">getkuby/kuby-kind</a></li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="the-bare-metal-provider">The Bare Metal Provider<a class="hash-link" href="#the-bare-metal-provider" title="Direct link to heading">‚Äã</a></h3><p>Kuby comes with a provider out of the box for connecting to arbitrary Kubernetes clusters called the &quot;bare metal&quot; provider. Use this provider if the cloud services company you&#x27;re using isn&#x27;t supported by Kuby (i.e. there is no provider gem available), or if you&#x27;re managing your cluster manually in-house. The bare metal provider requires that you already have a kubeconfig file.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>The kubeconfig file (so-called because it&#x27;s usually stored at ~/.kube/config) is a configuration file used by <code>kubectl</code> and other tools to communicate securely with a Kubernetes cluster. For more information, see the <a href="https://kubernetes.io/docs/concepts/configuration/organize-cluster-access-kubeconfig/" target="_blank" rel="noopener noreferrer">official Kubernetes documentation</a>.</p></div></div><p>The bare metal provider supports the following configuration options:</p><ul><li><code>kubeconfig(String)</code>: The path to the kubeconfig file.</li><li><code>storage_class(String)</code>: The Kubernetes storage class to use for requesting persistent volume storage. Defaults to &quot;hostpath&quot;.</li></ul><p>Configure the bare metal provider like so:</p><div class="codeBlockContainer_I0IT language-ruby theme-code-block"><div class="codeBlockContent_wNvx" style="color:#403f53;background-color:#FBFBFB"><pre tabindex="0" class="prism-code language-ruby codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#403f53"><span class="token plain">Kuby</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">define</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string-literal string" style="color:rgb(72, 118, 214)">&#x27;my-app&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  environment</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token symbol">:production</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    kubernetes </span><span class="token keyword" style="color:rgb(12, 150, 155)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      provider </span><span class="token symbol">:bare_metal</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        kubeconfig </span><span class="token string-literal string" style="color:rgb(72, 118, 214)">&#x27;/Users/me/.kube/config&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="plugins">Plugins<a class="hash-link" href="#plugins" title="Direct link to heading">‚Äã</a></h2><p>Nearly all Kuby&#x27;s functionality is provided as a series of plugins. Plugins can be added, configured, and removed inside the <code>kubernetes do ... end</code> block.</p><p>If you read the Getting Started section of this guide, you saw how to add and configure the <code>:rails_app</code> plugin. Let&#x27;s add Sidekiq queuing functionality as another example.</p><ol><li>First, you&#x27;ll need to add the <a href="https://github.com/mperham/sidekiq" target="_blank" rel="noopener noreferrer">sidekiq</a> and <a href="https://github.com/getkuby/kuby-sidekiq" target="_blank" rel="noopener noreferrer">kuby-sidekiq</a> gems to your Gemfile and run <code>bundle install</code>.</li><li>Next, add <code>require &#x27;kuby/sidekiq&#x27;</code> to the top of your Kuby config (i.e. in kuby.rb).</li><li>Add the plugin by calling <code>add_plugin :sidekiq</code>.</li><li>Add a few lines of Ruby code into an initializer to configure your app to use Sidekiq.</li></ol><div class="codeBlockContainer_I0IT language-ruby theme-code-block"><div style="color:#403f53;background-color:#FBFBFB" class="codeBlockTitle_BvAR">kuby.rb</div><div class="codeBlockContent_wNvx" style="color:#403f53;background-color:#FBFBFB"><pre tabindex="0" class="prism-code language-ruby codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(72, 118, 214)">&#x27;kuby/sidekiq&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">Kuby</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">define</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string-literal string" style="color:rgb(72, 118, 214)">&#x27;my-app&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  environment</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token symbol">:production</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    add_plugin </span><span class="token symbol">:sidekiq</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-ruby theme-code-block"><div style="color:#403f53;background-color:#FBFBFB" class="codeBlockTitle_BvAR">config/initializers/sidekiq.rb</div><div class="codeBlockContent_wNvx" style="color:#403f53;background-color:#FBFBFB"><pre tabindex="0" class="prism-code language-ruby codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#403f53"><span class="token keyword" style="color:rgb(12, 150, 155)">if</span><span class="token plain"> Rails</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">env</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">production</span><span class="token operator" style="color:rgb(12, 150, 155)">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">require</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(72, 118, 214)">&#x27;kuby&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  Kuby</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">load</span><span class="token operator" style="color:rgb(12, 150, 155)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  Sidekiq</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">configure_server </span><span class="token keyword" style="color:rgb(12, 150, 155)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain">config</span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    config</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">redis </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> Kuby</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">environment</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">kubernetes</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">plugin</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token symbol">:sidekiq</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">connection_params</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  Sidekiq</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">configure_client </span><span class="token keyword" style="color:rgb(12, 150, 155)">do</span><span class="token plain"> </span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain">config</span><span class="token operator" style="color:rgb(12, 150, 155)">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    config</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">redis </span><span class="token operator" style="color:rgb(12, 150, 155)">=</span><span class="token plain"> Kuby</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">environment</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">kubernetes</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">plugin</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token symbol">:sidekiq</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">connection_params</span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>You&#x27;ll need to run <code>kuby setup</code> and then <code>kuby deploy</code> again after completing these steps.</p></div></div><p>The kuby-sidekiq plugin handles all the necessary configuration to stand up an instance of Redis in your cluster, as well as a worker pod for processing background jobs.</p><p>Now let&#x27;s spin up another worker pod by passing a block to <code>add_plugin</code>:</p><div class="codeBlockContainer_I0IT language-ruby theme-code-block"><div class="codeBlockContent_wNvx" style="color:#403f53;background-color:#FBFBFB"><pre tabindex="0" class="prism-code language-ruby codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#403f53"><span class="token plain">add_plugin </span><span class="token symbol">:sidekiq</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  replicas </span><span class="token number" style="color:rgb(170, 9, 130)">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Running <code>kuby deploy</code> again will result in two worker pods.</p><p>To create your own plugins, see the <a href="/docs/creating-plugins">Creating Plugins</a> page in this guide.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="setup-and-remove-routines">Setup and Remove Routines<a class="hash-link" href="#setup-and-remove-routines" title="Direct link to heading">‚Äã</a></h3><p>Plugins can define setup and remove routines that are generally used to install and remove cluster-wide resources like Kubernetes operators. As we&#x27;ve seen elsewhere in this guide, setup routines are executed whenever the <code>kuby setup</code> command is executed, eg:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#403f53;background-color:#FBFBFB"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#403f53"><span class="token plain">bundle </span><span class="token builtin class-name" style="color:rgb(17, 17, 17)">exec</span><span class="token plain"> kuby -e production setup</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Remove routines are executed much more selectively via the <code>kuby plugin remove</code> command:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#403f53;background-color:#FBFBFB"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#403f53"><span class="token plain">bundle </span><span class="token builtin class-name" style="color:rgb(17, 17, 17)">exec</span><span class="token plain"> kuby -e production plugin remove </span><span class="token punctuation" style="color:rgb(153, 76, 195)">[</span><span class="token plain">plugin name</span><span class="token punctuation" style="color:rgb(153, 76, 195)">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="rake-tasks">Rake Tasks<a class="hash-link" href="#rake-tasks" title="Direct link to heading">‚Äã</a></h3><p>As of kuby-core v0.18, plugins can define <a href="https://github.com/ruby/rake" target="_blank" rel="noopener noreferrer">Rake</a> tasks.</p><p>To see a list of all available tasks, run:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#403f53;background-color:#FBFBFB"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#403f53"><span class="token plain">bundle </span><span class="token builtin class-name" style="color:rgb(17, 17, 17)">exec</span><span class="token plain"> kuby -e production plugin rake</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>To run a Rake task, append its name to the command:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#403f53;background-color:#FBFBFB"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#403f53"><span class="token plain">bundle </span><span class="token builtin class-name" style="color:rgb(17, 17, 17)">exec</span><span class="token plain"> kuby -e production plugin rake </span><span class="token operator" style="color:rgb(12, 150, 155)">&lt;</span><span class="token plain">task name</span><span class="token operator" style="color:rgb(12, 150, 155)">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="built-in-plugins">Built-in Plugins<a class="hash-link" href="#built-in-plugins" title="Direct link to heading">‚Äã</a></h2><p>Kuby comes with a set of built-in plugins like the <code>:rails_app</code> one we&#x27;ve seen already. The following sections describe these plugins and how to configure them.</p><p>Show all the plugins currently configured for the given environment (production in this case) by running:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#403f53;background-color:#FBFBFB"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#403f53"><span class="token plain">bundle </span><span class="token builtin class-name" style="color:rgb(17, 17, 17)">exec</span><span class="token plain"> kuby -e production plugin list</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>To show all the plugins Kuby knows about even if they aren&#x27;t configured for the given environment, pass the <code>--all</code> flag:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#403f53;background-color:#FBFBFB"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#403f53"><span class="token plain">bundle </span><span class="token builtin class-name" style="color:rgb(17, 17, 17)">exec</span><span class="token plain"> kuby -e production plugin list --all</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="the-rails-app-plugin">The Rails App Plugin<a class="hash-link" href="#the-rails-app-plugin" title="Direct link to heading">‚Äã</a></h3><p>The Rails app plugin generates all the configuration necessary to run your Rails app in your Kubernetes cluster, and supports the following configuration options.</p><ul><li><code>hostname(String)</code>: The hostname (i.e. domain name) for your app. Something like my-awesome-website.com, etc. Note that you will need to purchase a domain name and configure DNS properly to be able to reach your website.</li><li><code>tls_enabled(true | false)</code>: Whether or not the plugin should attempt to fetch and install a Let&#x27;s Encrypt TLS certificate for your app. Defaults to <code>true</code>.</li><li><code>manage_database(true | false)</code>: Whether or not the plugin should create a CockroachDB instance for your app. Defaults to <code>true</code>.</li><li><code>replicas(Integer)</code>: The number of instances of your app to run. Defaults to 1.</li><li><code>asset_url(String)</code>: The URL prefix to your app&#x27;s static assets. Defaults to /assets.</li><li><code>packs_url(String)</code>: The URL prefix to your app&#x27;s JavaScript packs (generated by webpack/webpacker). Defaults to /packs.</li><li><code>asset_path(String)</code>: The path on disk where your static assets reside. Defaults to ./public.</li></ul><p>For example, to disable TLS certificates, configure the plugin like this:</p><div class="codeBlockContainer_I0IT language-ruby theme-code-block"><div class="codeBlockContent_wNvx" style="color:#403f53;background-color:#FBFBFB"><pre tabindex="0" class="prism-code language-ruby codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#403f53"><span class="token plain">Kuby</span><span class="token punctuation" style="color:rgb(153, 76, 195)">.</span><span class="token plain">define</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token string-literal string" style="color:rgb(72, 118, 214)">&#x27;my-app&#x27;</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  environment</span><span class="token punctuation" style="color:rgb(153, 76, 195)">(</span><span class="token symbol">:production</span><span class="token punctuation" style="color:rgb(153, 76, 195)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    kubernetes </span><span class="token keyword" style="color:rgb(12, 150, 155)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      plugin </span><span class="token symbol">:rails_app</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(12, 150, 155)">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">        tls_enabled </span><span class="token boolean" style="color:rgb(188, 84, 84)">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">      </span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">    </span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain">  </span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#403f53"><span class="token plain"></span><span class="token keyword" style="color:rgb(12, 150, 155)">end</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>The remaining plugins listed below are automatically added and configured by the Rails app plugin, so there&#x27;s usually no need to configure them on your own.</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="the-rails-assets-plugin">The Rails Assets Plugin<a class="hash-link" href="#the-rails-assets-plugin" title="Direct link to heading">‚Äã</a></h3><p>The Rails assets plugin creates a separate Kubernetes deployment for serving your app&#x27;s static assets. A separate static asset server leaves your Rails app free to serve web requests. The plugin uses Nginx, a proven, high-performance web server.</p><ul><li><code>asset_url(String)</code>: The URL prefix to your app&#x27;s static assets. Defaults to /assets.</li><li><code>packs_url(String)</code>: The URL prefix to your app&#x27;s JavaScript packs (generated by webpack/webpacker). Defaults to /packs.</li><li><code>asset_path(String)</code>: The path on disk where your static assets reside. Defaults to ./public.</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="the-nginx-ingress-plugin">The Nginx Ingress Plugin<a class="hash-link" href="#the-nginx-ingress-plugin" title="Direct link to heading">‚Äã</a></h3><p>The Nginx ingress plugin is responsible for installing the <a href="https://github.com/kubernetes/ingress-nginx" target="_blank" rel="noopener noreferrer">ingress-nginx</a> Kubernetes operator. It has only one configuration option that is usually set by the provider.</p><ul><li><code>provider(String)</code>: Sets the provider. Must correspond to one of the available manifests <a href="https://github.com/kubernetes/ingress-nginx/tree/controller-v1.1.1/deploy/static/provider" target="_blank" rel="noopener noreferrer">here</a>. Defaults to using the &quot;cloud&quot; manifest.</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="the-crdb-plugin">The CRDB Plugin<a class="hash-link" href="#the-crdb-plugin" title="Direct link to heading">‚Äã</a></h3><p>The CRDB plugin is responsible for starting an instance of <a href="https://github.com/cockroachdb/cockroach" target="_blank" rel="noopener noreferrer">CockroachDB</a> for the Rails app.</p><ul><li><code>add_client_user(username: String)</code>: Adds an additional user that will be able to connect to the database. A separate certificate will be created and configured for the user.</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="additional-plugins">Additional Plugins<a class="hash-link" href="#additional-plugins" title="Direct link to heading">‚Äã</a></h2><p>The Kuby ecosystem features a number of other plugins distributed as Ruby gems.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="the-cert-manager-plugin">The cert-manager Plugin<a class="hash-link" href="#the-cert-manager-plugin" title="Direct link to heading">‚Äã</a></h3><p>Repository: <a href="https://github.com/getkuby/kuby-cert-manager" target="_blank" rel="noopener noreferrer">getkuby/kuby-cert-manager</a></p><p>The cert-manager plugin uses the awesome <a href="https://github.com/jetstack/cert-manager" target="_blank" rel="noopener noreferrer">cert-manager</a> operator to automatically request and install TLS certificates on your behalf. Behind the scenes, cert-manager uses <a href="https://letsencrypt.org/" target="_blank" rel="noopener noreferrer">Let&#x27;s Encrypt</a>, a non-profit certificate authority trusted by all the major browsers. You don&#x27;t need an account to use Let&#x27;s Encrypt, but you do need an email address. By default, the cert-manager plugin uses the email address you provided as part of your Docker registry credentials. A certificate will be issued for the hostname configured for your Rails app.</p><p>Moreover, the cert-manager plugin can be used to create custom public key infrastructures (PKIs). Take a look at the <a href="https://github.com/getkuby/kuby-core/blob/ab58f7cc308348ae492a2d37dcf88686d2292917/lib/kuby/plugins/rails_app/crdb/plugin.rb" target="_blank" rel="noopener noreferrer">CRDB plugin</a> for an example.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="the-prebundler-plugin">The Prebundler Plugin<a class="hash-link" href="#the-prebundler-plugin" title="Direct link to heading">‚Äã</a></h3><p>Repository: <a href="https://github.com/getkuby/kuby-prebundler" target="_blank" rel="noopener noreferrer">getkuby/kuby-prebundler</a></p><p>The Prebundler plugin uses <a href="https://github.com/camertron/prebundler" target="_blank" rel="noopener noreferrer">Prebundler</a> to dramatically improve the performance of <code>bundle install</code>, which can take a long time during Docker builds.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="the-redis-plugin">The Redis Plugin<a class="hash-link" href="#the-redis-plugin" title="Direct link to heading">‚Äã</a></h3><p>Repository: <a href="https://github.com/getkuby/kuby-redis" target="_blank" rel="noopener noreferrer">getkuby/kuby-redis</a></p><p>The Redis plugin uses the <a href="https://github.com/spotahome/redis-operator" target="_blank" rel="noopener noreferrer">Spotahome Redis operator</a> to stand up Redis instances in your cluster. It is used by the Sidekiq plugin (see below).</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="the-sidekiq-plugin">The Sidekiq Plugin<a class="hash-link" href="#the-sidekiq-plugin" title="Direct link to heading">‚Äã</a></h3><p>Repository: <a href="https://github.com/getkuby/kuby-sidekiq" target="_blank" rel="noopener noreferrer">getkuby/kuby-sidekiq</a></p><p>The Sidekiq plugin deploys <a href="https://github.com/mperham/sidekiq" target="_blank" rel="noopener noreferrer">Sidekiq</a> workers into your cluster for easy background job processing.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="the-anycable-plugin">The AnyCable Plugin<a class="hash-link" href="#the-anycable-plugin" title="Direct link to heading">‚Äã</a></h3><p>Repository: <a href="https://github.com/anycable/kuby-anycable" target="_blank" rel="noopener noreferrer">anycable/kuby-anycable</a></p><p>The AnyCable plugin allows you to install all the required <a href="https://anycable.io/" target="_blank" rel="noopener noreferrer">AnyCable</a> components to your Kubernetes cluster.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/getkuby/kuby-core/edit/master/docs/docs/customizing_deployments.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/understanding-kubernetes"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Understanding Kubernetes</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/creating-plugins"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Creating Your Own Plugins</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#providers" class="table-of-contents__link toc-highlight">Providers</a><ul><li><a href="#available-provider-gems" class="table-of-contents__link toc-highlight">Available Provider Gems</a></li><li><a href="#the-bare-metal-provider" class="table-of-contents__link toc-highlight">The Bare Metal Provider</a></li></ul></li><li><a href="#plugins" class="table-of-contents__link toc-highlight">Plugins</a><ul><li><a href="#setup-and-remove-routines" class="table-of-contents__link toc-highlight">Setup and Remove Routines</a></li><li><a href="#rake-tasks" class="table-of-contents__link toc-highlight">Rake Tasks</a></li></ul></li><li><a href="#built-in-plugins" class="table-of-contents__link toc-highlight">Built-in Plugins</a><ul><li><a href="#the-rails-app-plugin" class="table-of-contents__link toc-highlight">The Rails App Plugin</a></li><li><a href="#the-rails-assets-plugin" class="table-of-contents__link toc-highlight">The Rails Assets Plugin</a></li><li><a href="#the-nginx-ingress-plugin" class="table-of-contents__link toc-highlight">The Nginx Ingress Plugin</a></li><li><a href="#the-crdb-plugin" class="table-of-contents__link toc-highlight">The CRDB Plugin</a></li></ul></li><li><a href="#additional-plugins" class="table-of-contents__link toc-highlight">Additional Plugins</a><ul><li><a href="#the-cert-manager-plugin" class="table-of-contents__link toc-highlight">The cert-manager Plugin</a></li><li><a href="#the-prebundler-plugin" class="table-of-contents__link toc-highlight">The Prebundler Plugin</a></li><li><a href="#the-redis-plugin" class="table-of-contents__link toc-highlight">The Redis Plugin</a></li><li><a href="#the-sidekiq-plugin" class="table-of-contents__link toc-highlight">The Sidekiq Plugin</a></li><li><a href="#the-anycable-plugin" class="table-of-contents__link toc-highlight">The AnyCable Plugin</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Quick Start Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/why">Why Docker and Kubernetes?</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/getkuby" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/camertron" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 @camertron. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.a05fbcc2.js"></script>
<script src="/assets/js/main.b30adce0.js"></script>
</body>
</html>